<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Rain</title>
    <style>
        body {
            background-color: #000000;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            overflow: hidden;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            display: block;
        }

        /* Load the custom font from the same folder */
        @font-face {
            font-family: 'CustomFont';
            src: url('font.ttf') format('truetype');
        }
    </style>
</head>
<body>
    <script>
        var canvas = document.body.appendChild(document.createElement('canvas')),
            context = canvas.getContext('2d');
        context.globalCompositeOperation = 'lighter';

        // Resize the canvas to fit the window
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        var textStrip = ['R', 'A', 'I', 'N'];
        var stripCount = 256, stripX = [], stripY = [], dY = [], stripFontSize = [];

        // Pre-calculate values for strips once
        for (var i = 0; i < stripCount; i++) {
            stripX[i] = Math.random() * canvas.width;
            stripY[i] = -Math.random() * canvas.height; // Start offscreen
            stripFontSize[i] = Math.random() * 8 + 6;  // Reduced font size
            dY[i] = (Math.random() * 7 + 3) * (10 / stripFontSize[i]); // Speed based on font size
        }

        var theColors = ['#62BAE0'];

        // Variables to track mouse position and velocity
        var lastMouseX = 0, lastMouseY = 0;
        var mouseSpeed = 0;
        var lastMouseUpdateTime = 0;

        // Update mouse speed every 50ms instead of on every movement
        window.addEventListener('mousemove', function (e) {
            var currentTime = Date.now();
            if (currentTime - lastMouseUpdateTime < 50) return; // Skip updates faster than 50ms intervals

            var mouseX = e.clientX;
            var mouseY = e.clientY;

            // Calculate mouse speed (distance moved per frame)
            var dx = mouseX - lastMouseX;
            var dy = mouseY - lastMouseY;
            mouseSpeed = Math.sqrt(dx * dx + dy * dy);

            lastMouseX = mouseX;
            lastMouseY = mouseY;
            lastMouseUpdateTime = currentTime;
        });

        function drawStrip(x, y, fontSize) {
            for (var k = 0; k < 4; k++) {  // Limiting to 4 characters per strip
                var randChar = textStrip[Math.floor(Math.random() * textStrip.length)];
                context.fillStyle = theColors[Math.min(k, theColors.length - 1)];
                context.fillText(randChar, x, y);
                y -= fontSize;
            }
        }

        function draw() {
            context.clearRect(0, 0, canvas.width, canvas.height);

            // Adjust the rain speed based on the mouse speed
            var speedFactor = 1 + (mouseSpeed / 100);  // The faster the mouse, the faster the rain

            // Draw the text strips with the custom font
            for (var j = 0; j < stripCount; j++) {
                context.font = stripFontSize[j] + 'px CustomFont'; // Use the custom font
                context.textBaseline = 'top';
                context.textAlign = 'center';

                // Reset position when it moves off the screen
                if (stripY[j] > canvas.height + 100) {
                    stripX[j] = Math.random() * canvas.width;
                    stripY[j] = -Math.random() * canvas.height; // Ensure it starts off-screen
                    stripFontSize[j] = Math.random() * 8 + 6; // Keep the smaller font size
                    dY[j] = (Math.random() * 7 + 3) * (10 / stripFontSize[j]); // Recalculate speed
                }

                // Adjust speed of the rain based on mouse movement
                drawStrip(stripX[j], stripY[j], stripFontSize[j]);
                stripY[j] += dY[j] * speedFactor;  // Multiply dY by the speed factor
            }

            requestAnimationFrame(draw); // Keep animating
        }

        draw(); // Start the animation
    </script>
</body>
</html>